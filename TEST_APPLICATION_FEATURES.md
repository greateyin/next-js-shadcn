# Application 功能測試指南

## 🚀 快速啟動

### 1. 啟動開發伺服器

```bash
pnpm dev
```

### 2. 訪問應用程式管理頁面

```
http://localhost:3000/admin/applications
```

## ✅ 測試檢查清單

### 基本功能測試

#### 1. 查看應用程式列表
- [ ] 頁面正常載入
- [ ] 顯示所有應用程式
- [ ] 顯示正確的欄位（名稱、路徑、狀態、角色等）
- [ ] 排序功能正常

#### 2. 搜尋和篩選
- [ ] 在搜尋框輸入應用程式名稱
- [ ] 結果即時更新
- [ ] 搜尋結果正確

#### 3. 分頁功能
- [ ] Previous/Next 按鈕正常工作
- [ ] 顯示正確的分頁資訊

### CRUD 操作測試

#### 4. 新增應用程式 ✨

**步驟：**
1. 點擊「新增應用程式」按鈕
2. 填寫表單：
   - 應用程式名稱：`test-app`
   - 顯示名稱：`測試應用`
   - 路徑：`admin/test`
   - 描述：`這是測試應用程式`
   - 圖標：選擇任意圖標
   - 排序：`10`
   - 啟用狀態：開啟
3. 點擊「創建」

**預期結果：**
- [ ] 表單驗證正常
- [ ] 顯示成功 Toast 訊息
- [ ] 對話框關閉
- [ ] 表格自動刷新，顯示新應用程式

**錯誤測試：**
- [ ] 嘗試使用重複的名稱 → 應顯示錯誤訊息
- [ ] 嘗試使用重複的路徑 → 應顯示錯誤訊息
- [ ] 留空必填欄位 → 應顯示驗證錯誤

#### 5. 編輯應用程式 ✏️

**步驟：**
1. 點擊任意應用程式的操作選單（三點圖標）
2. 選擇「編輯」
3. 修改任意欄位
4. 點擊「更新」

**預期結果：**
- [ ] 對話框顯示現有資料
- [ ] 修改成功
- [ ] 顯示成功 Toast 訊息
- [ ] 表格資料更新

#### 6. 啟用/停用應用程式 🔌

**步驟：**
1. 點擊操作選單
2. 選擇「啟用」或「停用」

**預期結果：**
- [ ] 狀態即時更新
- [ ] Badge 顏色改變（綠色=Active，灰色=Inactive）
- [ ] 顯示成功 Toast 訊息

#### 7. 管理角色存取 🔒

**步驟：**
1. 點擊操作選單
2. 選擇「管理角色存取」
3. 選擇/取消選擇角色
4. 測試「全選」和「取消全選」按鈕
5. 點擊「儲存」

**預期結果：**
- [ ] 對話框顯示所有可用角色
- [ ] 當前角色正確標記為已選
- [ ] 全選/取消全選功能正常
- [ ] 儲存成功
- [ ] 表格中「角色」欄位更新

#### 8. 刪除應用程式 🗑️

**測試場景 A：刪除沒有關聯的應用程式**

**步驟：**
1. 創建一個新的測試應用程式
2. 點擊操作選單
3. 選擇「刪除」
4. 確認刪除

**預期結果：**
- [ ] 顯示確認對話框
- [ ] 刪除成功
- [ ] 顯示成功 Toast 訊息
- [ ] 應用程式從列表中移除

**測試場景 B：刪除有關聯的應用程式**

**步驟：**
1. 嘗試刪除有選單項目或角色關聯的應用程式
2. 點擊操作選單
3. 選擇「刪除」

**預期結果：**
- [ ] 顯示錯誤訊息
- [ ] 說明無法刪除的原因（有 X 個關聯項目）
- [ ] 應用程式保持不變

## 🔍 邊界情況測試

### 驗證測試

1. **名稱驗證**
   - [ ] 空名稱 → 錯誤
   - [ ] 超長名稱（>50字元）→ 錯誤
   - [ ] 特殊字符（中文、空格）→ 錯誤
   - [ ] 有效名稱（英數字、連字符、底線）→ 成功

2. **路徑驗證**
   - [ ] 空路徑 → 錯誤
   - [ ] 無效字符 → 錯誤
   - [ ] 有效路徑 → 成功

3. **排序驗證**
   - [ ] 負數 → 錯誤
   - [ ] 小數 → 錯誤
   - [ ] 有效整數 → 成功

### 並發測試

1. **快速操作**
   - [ ] 快速連續點擊按鈕 → 應防止重複提交
   - [ ] 載入狀態顯示正確

2. **多個對話框**
   - [ ] 同時打開多個對話框 → 應正確處理

### 錯誤處理

1. **網路錯誤模擬**
   - [ ] 關閉網路後操作 → 顯示適當錯誤訊息
   - [ ] 操作按鈕顯示載入狀態

2. **會話過期**
   - [ ] 登出後嘗試操作 → 應顯示未授權錯誤

## 📊 資料完整性檢查

### 資料庫檢查

使用 Prisma Studio 驗證：

```bash
pnpm prisma studio
```

檢查項目：
- [ ] `Application` 表資料正確
- [ ] `RoleApplication` 關聯正確
- [ ] `AuditLog` 記錄所有操作

### 審計日誌檢查

查看所有操作是否記錄：
- [ ] CREATE_APPLICATION
- [ ] UPDATE_APPLICATION
- [ ] ENABLE_APPLICATION / DISABLE_APPLICATION
- [ ] DELETE_APPLICATION
- [ ] MANAGE_APPLICATION_ROLES

## 🎨 UI/UX 測試

### 響應式設計
- [ ] 桌面瀏覽器 (>1024px)
- [ ] 平板 (768px - 1024px)
- [ ] 手機 (<768px)

### 瀏覽器兼容性
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

### 無障礙測試
- [ ] 鍵盤導航
- [ ] Tab 順序正確
- [ ] Enter/Escape 快捷鍵
- [ ] 螢幕閱讀器支援

## 🐛 已知問題

目前無已知問題。

## 📝 測試記錄

| 測試項目 | 狀態 | 測試者 | 日期 | 備註 |
|---------|------|--------|------|------|
| 基本列表顯示 | ⏳ | - | - | - |
| 新增應用程式 | ⏳ | - | - | - |
| 編輯應用程式 | ⏳ | - | - | - |
| 刪除應用程式 | ⏳ | - | - | - |
| 角色存取管理 | ⏳ | - | - | - |
| 啟用/停用 | ⏳ | - | - | - |

**圖例：**
- ⏳ 待測試
- ✅ 通過
- ❌ 失敗
- ⚠️ 部分通過

## 🚨 緊急回滾

如果發現重大問題，可以回滾到重構前：

```bash
git log --oneline
git revert <commit-hash>
```

## 📞 報告問題

發現問題請記錄：
1. 重現步驟
2. 預期結果
3. 實際結果
4. 瀏覽器/環境資訊
5. 截圖或錯誤訊息
